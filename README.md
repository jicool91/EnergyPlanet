# Energy Planet

Idle tap –∏–≥—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Telegram Mini App. –†–∞–∑–≤–∏–≤–∞–π —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–ª–∞–Ω–µ—Ç—ã, –Ω–∞–∫–∞–ø–ª–∏–≤–∞–π —ç–Ω–µ—Ä–≥–∏—é —á–µ—Ä–µ–∑ —Ç–∞–ø—ã –∏ –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç –ø–æ—Å—Ç—Ä–æ–µ–∫.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **Idle Tap –≥–µ–π–º–ø–ª–µ–π**: —Ç–∞–ø–∞–π –ø–ª–∞–Ω–µ—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏
- **–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–∫**: 8 —Ç–∏–ø–æ–≤ –ø–æ—Å—Ç—Ä–æ–µ–∫ (–æ—Ç —Å–æ–ª–Ω–µ—á–Ω—ã—Ö –ø–∞–Ω–µ–ª–µ–π –¥–æ –∫–≤–∞–Ω—Ç–æ–≤—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤)
- **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è**: —Å–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π –∏ –æ–ø—ã—Ç–∞
- **–ö–æ—Å–º–µ—Ç–∏–∫–∞**: —Ä–∞–º–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤, —Å–∫–∏–Ω—ã –ø–ª–∞–Ω–µ—Ç, —ç—Ñ—Ñ–µ–∫—Ç—ã —Ç–∞–ø–∞, —Ñ–æ–Ω—ã
- **–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–∏—á–∏**: –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏ –Ω–µ–¥–µ–ª—å–Ω—ã–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥—ã, –æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π
- **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è**: Telegram Stars, Rewarded Ads
- **Post-MVP**: –∫–ª–∞–Ω—ã, –∞—Ä–µ–Ω–∞/PvP, –∞—á–∏–≤–∫–∏, –¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend
- **Runtime**: Node.js 18+
- **Framework**: Express.js (TypeScript)
- **Database**: PostgreSQL 15
- **Cache**: Redis 7
- **Queue**: BullMQ
- **Auth**: JWT + Telegram OAuth

### Frontend
- **Framework**: React 18 (TypeScript)
- **Build Tool**: Vite
- **State**: Zustand
- **API Client**: Axios
- **UI**: Telegram UI Kit + Custom

### Infrastructure
- **Containers**: Docker
- **Orchestration**: Kubernetes
- **CI/CD**: Jenkins
- **Monitoring**: Prometheus + Grafana

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Node.js 18+
- Docker & Docker Compose
- PostgreSQL 15+ (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Docker)
- Redis 7+ (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Docker)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
```bash
git clone https://github.com/yourusername/energyPlanet.git
cd energyPlanet
```

2. **–ù–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
# Backend
cd backend
cp .env.sample .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env –∏ –∑–∞–ø–æ–ª–Ω–∏ TELEGRAM_BOT_TOKEN –∏ –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è

# Webapp
cd ../webapp
cp .env.sample .env
```

3. **–ó–∞–ø—É—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é Docker Compose**
```bash
docker-compose up
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç:
- PostgreSQL (–ø–æ—Ä—Ç 5432)
- Redis (–ø–æ—Ä—Ç 6379)
- Backend API (–ø–æ—Ä—Ç 3000)
- Webapp dev server (–ø–æ—Ä—Ç 5173)

4. **–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
- Backend API: http://localhost:3000
- Webapp: http://localhost:5173
- Health check: http://localhost:3000/health

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ Docker

**Backend:**
```bash
cd backend
npm install
npm run dev
```

**Webapp:**
```bash
cd webapp
npm install
npm run dev
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
energyPlanet/
‚îú‚îÄ‚îÄ backend/              # Node.js API —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ webapp/               # React Telegram Mini App
‚îú‚îÄ‚îÄ content/              # –ò–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (JSON/YAML)
‚îú‚îÄ‚îÄ k8s/                  # Kubernetes –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ GDD.md           # Game Design Document
‚îÇ   ‚îú‚îÄ‚îÄ MVP_SPEC.md      # MVP —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ ROADMAP.md       # –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ API_OPENAPI.yaml # OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Jenkinsfile          # CI/CD –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ docker-compose.yml   # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îî‚îÄ‚îÄ README.md
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë
docker-compose up

# –¢–µ—Å—Ç—ã backend
cd backend && npm test

# –õ–∏–Ω—Ç–∏–Ω–≥
cd backend && npm run lint
cd webapp && npm run lint

# Type checking
cd backend && npm run typecheck
cd webapp && npm run typecheck
```

### –°–±–æ—Ä–∫–∞
```bash
# Backend
cd backend && npm run build

# Webapp
cd webapp && npm run build

# Docker –æ–±—Ä–∞–∑—ã
docker build -t energy-planet-backend ./backend
docker build -t energy-planet-webapp ./webapp
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
cd backend && npm run migrate:up

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
cd backend && npm run migrate:down
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[GDD (Game Design Document)](docs/GDD.md)** - –¥–∏–∑–∞–π–Ω –∏–≥—Ä—ã, —ç–∫–æ–Ω–æ–º–∏–∫–∞, –±–∞–ª–∞–Ω—Å, —Ñ–æ—Ä–º—É–ª—ã
- **[MVP Specification](docs/MVP_SPEC.md)** - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª MVP, user flows, –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è
- **[Roadmap](docs/ROADMAP.md)** - –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è (MVP ‚Üí –ö–ª–∞–Ω—ã ‚Üí –ê—Ä–µ–Ω–∞)
- **[API Documentation](docs/API_OPENAPI.yaml)** - OpenAPI 3.0 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- **[CLAUDE.md](CLAUDE.md)** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Claude Code

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### Content-as-Data
–í–µ—Å—å –∏–≥—Ä–æ–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö `/content/`:
- `items/buildings.json` - —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–æ—Å—Ç—Ä–æ–µ–∫
- `cosmetics/skins.json` - –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã
- `seasons/season_001.yaml` - —Å–µ–∑–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `flags/default.json` - feature flags

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –±–µ–∑ –¥–µ–ø–ª–æ—è –∫–æ–¥–∞
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Git
- –õ–µ–≥–∫–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∑–∞–π–Ω–µ—Ä–∞–º–∏

### Anti-Cheat
–°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –∏–≥—Ä–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:
- **Tap validation**: max 10 TPS
- **Energy validation**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ñ–æ—Ä–º—É–ª–∞–º
- **Purchase idempotency**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ UUID –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏

### Feature Flags
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏—á–∞–º–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥:
```json
{
  "features": {
    "tier_4_buildings_enabled": false,
    "clan_system_enabled": false
  }
}
```

## –î–µ–ø–ª–æ–π

### Production (Kubernetes)

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
kubectl apply -f k8s/namespace.yaml
kubectl apply -f k8s/configmap.yaml
kubectl apply -f k8s/secrets.yaml  # –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏ —Å–µ–∫—Ä–µ—Ç—ã!
kubectl apply -f k8s/deploy.yaml

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
kubectl get pods -n energy-planet
kubectl logs -f deployment/backend -n energy-planet
```

### CI/CD (Jenkins)

–ü—É—à –≤ `main` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω:
1. –¢–µ—Å—Ç—ã (lint, typecheck, unit tests)
2. –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
3. Push –≤ registry
4. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
5. –î–µ–ø–ª–æ–π –≤ Kubernetes
6. Smoke tests

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit tests
cd backend && npm test

# Integration tests
cd backend && npm run test:integration

# Coverage
cd backend && npm run test -- --coverage

# Load testing (—Ç—Ä–µ–±—É–µ—Ç k6)
k6 run tests/load/tap_test.js
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **Health check**: GET /health
- **Metrics**: Prometheus –Ω–∞ –ø–æ—Ä—Ç—É 9090
- **Logs**: Winston (JSON format –≤ production)
- **Dashboards**: Grafana

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Telegram OAuth —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ö–µ—à–∞
- ‚úÖ JWT tokens (access 15min, refresh 30d)
- ‚úÖ Rate limiting –Ω–∞ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö
- ‚úÖ SQL injection protection (parameterized queries)
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Helmet.js –¥–ª—è HTTP headers
- ‚úÖ Server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **API Response (p95)**: < 100ms
- **API Response (p99)**: < 300ms
- **Throughput**: 1000 req/sec
- **Frontend FCP**: < 1.5s
- **Frontend TTI**: < 2.5s
- **Tap latency**: < 50ms

## Roadmap

### ‚úÖ MVP (8 –Ω–µ–¥–µ–ª—å)
- –ë–∞–∑–æ–≤—ã–π –≥–µ–π–º–ø–ª–µ–π (tap, buildings, upgrades)
- –ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è (levels, XP)
- –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã
- –ö–æ—Å–º–µ—Ç–∏–∫–∞
- –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è (Stars + Ads)

### üöß Phase 2: –ö–ª–∞–Ω—ã (6 –Ω–µ–¥–µ–ª—å)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–Ω–∞–º–∏
- –ö–ª–∞–Ω–æ–≤—ã–π —á–∞—Ç
- –ö–ª–∞–Ω–æ–≤—ã–µ –ø–µ—Ä–∫–∏
- –ö–ª–∞–Ω–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è

### üìÖ Phase 3: –ê—Ä–µ–Ω–∞/PvP (8 –Ω–µ–¥–µ–ª—å)
- Matchmaking —Å–∏—Å—Ç–µ–º–∞
- ELO —Ä–µ–π—Ç–∏–Ω–≥
- –°–µ–∑–æ–Ω—ã –∏ –Ω–∞–≥—Ä–∞–¥—ã
- –¢—É—Ä–Ω–∏—Ä—ã

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [ROADMAP.md](docs/ROADMAP.md)

## FAQ

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–¥–∞–Ω–∏–µ?**
A: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `/content/items/buildings.json` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend. –ö–æ–¥ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.

**Q: –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Telegram WebApp –ª–æ–∫–∞–ª—å–Ω–æ?**
A: –ò—Å–ø–æ–ª—å–∑—É–π [ngrok](https://ngrok.com/) –¥–ª—è —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è localhost –∏ –Ω–∞—Å—Ç—Ä–æ–π Telegram Bot URL.

**Q: –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–µ–∫—Ä–µ—Ç—ã –≤ production?**
A: Kubernetes Secrets (—Å–º. `k8s/secrets.yaml` template).

**Q: –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π?**
A: `kubectl rollout undo deployment/backend -n energy-planet`

## –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π feature branch (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤ branch (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π Pull Request

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **Telegram**: @energyplanet_support
- **Email**: support@energyplanet.game
- **Issues**: [GitHub Issues](https://github.com/yourusername/energyPlanet/issues)

---

–°–¥–µ–ª–∞–Ω–æ —Å ‚ö° Energy Planet Team
