# Task 01 — Админские элементы vs пользовательский UX (2025-11-06)

## Цель
Перенести административные действия из основных пользовательских экранов в отдельный поток, соответствующий рекомендациям Telegram Mini Apps по навигации и безопасной области.

## Исходное состояние
- На `TapScreen`, `ExchangeScreen`, `EarnScreen` и других пользовательских вкладках выводится кнопка `Админ`/`Админ. метрики`, которая:
  - перекрывает основной контент (к примеру, на главной уходит за правый край);
  - доступна всем пользователям до проверки роли;
  - создаёт когнитивный шум и нарушает принцип «только основные маршруты на нижней навигации».
- Админские CTA дублируют функциональность, доступную через `AdminMonetizationScreen`, но находятся в нескольких местах.

## Требования Telegram Mini Apps
- Навигация в мини-приложениях должна повторять мобильные паттерны и сосредотачиваться на ключевых пользовательских сценариях; второстепенные потоки (например, административные) рекомендуется выносить из основной навигации.
- Верхние/нижние панели обязаны учитывать safe area и не перекрывать системные элементы — любые выступающие кнопки нарушают эти требования.
- Main/Secondary Button предназначены для основных CTA и должны использоваться осознанно, чтобы не перегружать интерфейс.

## Риски текущего подхода
- **Фокус и доступность**: админ-кнопка без проверки роли вводит в заблуждение игроков и нарушает ожидаемый сценарий bottom navigation.
- **Safe area**: элементы, выходящие за правый край, игнорируют `safeAreaInsets`, нарушая рекомендации SDK.
- **Поддержка дизайн-системы**: каждая «вставленная» кнопка увеличивает поверхность для багов и делает сложнее переход Stage F/G.

## Рекомендованное решение
1. **Единый вход в админку**  
   - Добавить раздел «Администрирование» в `ProfileScreen` или отдельный модальный лист `AdminActionsSheet`.  
   - Проверять роль (`gameStore.isAdmin`) до рендера листа.

2. **Удалить административные CTA с пользовательских экранов**  
   - `TapScreen`: убрать обзоры админских метрик/кнопки, использовать уведомления только в профиле.  
   - `ExchangeScreen`: удалить `Админ. метрики` из панели построек.  
   - `EarnScreen`: убрать передачу `onShowAdminPanel` в `ProfileSettingsScreen`.

3. **Поддержка SDK**  
   - При открытии админ-листа использовать Telegram Main/Secondary Button с контекстной подсветкой, если требуется глобальный CTA.
   - Если нужен быстрый доступ, воспользоваться `setHeaderColor`/`setBackgroundColor`, чтобы выделить административный режим без вмешательства в пользовательские панели.

## Следующие шаги
1. Доработать `ProfileScreen`/`AdminActionsSheet` — дизайн-сценарий и роутинг.  
2. Удалить админ-кнопки с основных экранов и обновить визуальные тесты.  
3. Обновить `docs/qa/stage-f-checklist.md` (проверка отсутствия админ-CTA на пользовательских вкладках) и `docs/release-notes/stage-f.md` (упоминание нового входа в админку).
